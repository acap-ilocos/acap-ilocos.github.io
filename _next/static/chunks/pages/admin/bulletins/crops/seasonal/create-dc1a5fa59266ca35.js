(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7970],{40108:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/seasonal/create",function(){return t(77811)}])},77811:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return le}});var r=t(34051),o=t.n(r),i=t(85893),a=t(67294),u=t(9473),l=t(16327),c=t(30560),s=t(87006),f=t(87682),d=t(53063),p=t(12671),v=t(61690),m=t(59111),h=t(87784),g=t(52955),b=t(59390),y=t(23766),_=t(38885),S=t(22856),x=t(1096);function w(e,n,t,r,o,i,a){try{var u=e[i](a),l=u.value}catch(c){return void t(c)}u.done?n(l):Promise.resolve(l).then(r,o)}function O(e,n,t){var r=(0,a.useState)([]),i=r[0],u=r[1],l=(0,a.useState)(!1),c=l[0],s=l[1],f=(0,a.useState)(""),d=f[0],p=f[1];return(0,a.useEffect)((function(){var r=function(){var r,i=(r=o().mark((function r(){var i,a,l,c;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i=[],s(!1),p(""),r.next=6,(0,x.iR)({crop:e,climateRisk:n,type:t});case 6:i=r.sent,s(!1),u(i||[]),r.next=18;break;case 11:r.prev=11,r.t0=r.catch(0),c=null!==(l=null===r.t0||void 0===r.t0||null===(a=r.t0.response)||void 0===a?void 0:a.data)&&void 0!==l?l:r.t0.message,p(c),s(!1);case 18:case"end":return r.stop()}}),r,null,[[0,11]])})),function(){var e=this,n=arguments;return new Promise((function(t,o){var i=r.apply(e,n);function a(e){w(i,t,o,a,u,"next",e)}function u(e){w(i,t,o,a,u,"throw",e)}a(void 0)}))});return function(){return i.apply(this,arguments)}}();e&&t?r():u([])}),[e,n,t]),{recommendationsSMS:i,loading:c,error:d}}function j(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function E(e){var n=(0,a.useState)([]),t=n[0],r=n[1],o=(0,a.useState)(""),i=o[0],u=o[1];(0,a.useEffect)((function(){if(u(""),(null===e||void 0===e?void 0:e.length)>0)try{var n=e.map((function(e){return{impact:e.impact_outlook_english,impact_tagalog:e.impact_outlook_tagalog}})).filter((function(e){return""!==e.impact_outlook_english&&""!==e.impact_outlook_tagalog}));return n=c(n),void r([{impact:l(n.impact),impact_tagalog:l(n.impact_tagalog)}])}catch(t){u(t)}else r([])}),[e]);var l=function(e){var n="-",t=e.reduce((function(e,t){return t.includes("<p>")?("list"===n&&(e+="</ul>"),e+=t,n="p"):(["-","p"].includes(n)&&(e+="<ul>"),e+=t,n="list"),e}),"");return"list"===n&&(t+="</ul>"),t},c=function(e){var n={impact:[],impact_tagalog:[]};return e.reduce((function(e,t){return Object.keys(e).forEach((function(r){var o=t[r].replace(/<ul>/g,"");(o=(o=o.replace(/<\/ul>/g,"")).replace(/<li>/g,"")).split("</li>").forEach((function(t){t.includes("<p>")?t.replace(/<p>/g,"").split("</p>").forEach((function(t){n[r].includes(t)||""===t||(n[r].push(t),e[r].push("<p>".concat(t,"</p>")))})):n[r].includes(t)||""===t||(n[r].push(t),e[r].push("<li>".concat(t,"</li>")))}))})),function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){j(e,n,t[n])}))}return e}({},e)}),{impact:[],impact_tagalog:[]})};return{group:t,error:i}}var A=t(47426),k={forecast:"",label:"",value:0};var P=t(15497),I=t(901),R=t(27392),Z=t(95243),C=t(11163),N=t(45697),M=t.n(N),T=t(21023),L=t(93946),D=t(41664),B=t(76295),F=t(87357),U=t(11057),H=t(56863),W=t(86886),q=t(61903),G=t(15861),$=t(11829),z=t(19227),V=t(22757);function X(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){X(e,n,t[n])}))}return e}function J(e){var n=(0,a.useState)(!1),t=n[0],r=n[1],o=(0,a.useRef)(!0),l=(0,C.useRouter)(),c=(0,u.I0)(),s=e.sel_options,f=e.optsprovinces,d=e.optscrops,v=e.loading,m=e.isloadingreport,h=e.message,g=e.handleSave,b=e.togglePrompt,y=e.onSelectItemChange,_=e.resetSelections;(0,a.useEffect)((function(){return o.current=!0,function(){o.current=!1}}),[]),(0,a.useEffect)((function(){null===s.sel_month&&!0===t&&r(!1)}),[s.sel_month,t]);var S=function(){c((0,p.s_)()),l.push("/admin/bulletins/crops/")},x=function(){var e="Loading...";return f.length>0&&(e=null===s.sel_province?"Select a province":"Province"),e};return M().node,M().number.isRequired,M().number.isRequired,(0,i.jsxs)("div",{children:[(0,i.jsx)(z.Z,{isOpen:h.isOpen,maxWidth:"xs",openButtonText:null,title:h.title,contentText:h.msg,loading:h.loading,modalCancelHandlerCB:function(){h.savesuccess?S():b()},modalConfirmHandlerCB:function(){h.savesuccess?S():g()}}),(0,i.jsxs)(W.ZP,{container:!0,sx:V.Z.container,children:[(0,i.jsxs)(F.Z,{sx:V.Z.headerText,children:[(0,i.jsxs)(F.Z,{children:[(0,i.jsx)(G.Z,{variant:"h5",children:"Regional Seasonal Climate Outlook and Advisory Crop Recommendations Bulletin"}),(0,i.jsxs)("p",{children:["Create ",(0,i.jsx)("strong",{children:"Seasonal"})," crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]})]}),(0,i.jsx)(F.Z,{children:(0,i.jsx)(L.Z,{"aria-label":"exit",size:"medium",children:(0,i.jsx)(D.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,i.jsx)(T.Z,{fontSize:"inherit"})})})})]}),(0,i.jsxs)(W.ZP,{item:!0,sx:V.Z.item,xs:12,lg:4,children:[(0,i.jsx)(G.Z,{variant:"h6",children:"Selection Options"}),(0,i.jsx)(B.Z,{disablePortal:!0,id:"province",size:"small",value:s.sel_province,disabled:0===f.length||v,options:f,sx:V.Z.autocomplete,PaperComponent:$.Z,renderInput:function(e){return(0,i.jsx)(q.Z,Y({},e,{label:x()}))},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return y(e,Y({},n,{from:"province"}))}}),(0,i.jsx)(B.Z,{disablePortal:!0,id:"crop",size:"small",value:s.sel_crop,disabled:0===d.length||null===s.sel_province||v,options:d,sx:V.Z.autocomplete,PaperComponent:$.Z,renderInput:function(e){return(0,i.jsx)(q.Z,Y({},e,{label:null===s.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return y(e,Y({},n,{from:"crop"}))}}),(0,i.jsxs)(H.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:m||null===s.sel_crop||null===s.sel_month,sx:{marginTop:"16px",float:"right"},children:[(0,i.jsx)(U.Z,{variant:"outlined",disabled:v||m,onClick:_,children:"Reset"}),(0,i.jsx)(U.Z,{variant:"contained",onClick:b,disabled:v||null===s.sel_month||t,children:"Generate"})]})]})]})]})}J.propTypes={optsprovinces:M().array,optscrops:M().array,loading:M().bool,isloadingreport:M().bool,message:M().object,onSelectItemChange:M().func,handleSave:M().func,resetSelections:M().func,togglePrompt:M().func};var Q=J,K=t(66383);function ee(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ne(e,n,t,r,o,i,a){try{var u=e[i](a),l=u.value}catch(c){return void t(c)}u.done?n(l):Promise.resolve(l).then(r,o)}function te(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){ne(i,r,o,a,u,"next",e)}function u(e){ne(i,r,o,a,u,"throw",e)}a(void 0)}))}}function re(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function oe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){re(e,n,t[n])}))}return e}function ie(e){return function(e){if(Array.isArray(e))return ee(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return ee(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ee(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ae={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:[],sel_month:null,sel_condition:{id:0,from:"weather_condition",label:A.MW.WAY_BELOW_NORMAL.label},loading:!1,error:"",success:""},ue={url:"",filename:""};var le=(0,Z.Z)((function(e){var n=e.user,t=e.onBtnLogoutClick,r=e.loading,x=(0,a.useState)(ae),w=x[0],j=x[1],Z=(0,a.useState)({}),C=Z[0],N=Z[1],M=(0,a.useState)({}),T=M[0],L=M[1],D=(0,a.useState)([]),B=D[0],F=D[1],U=(0,a.useState)([]),H=U[0],W=U[1],q=(0,a.useState)([]),G=q[0],$=q[1],z=(0,a.useState)([]),V=z[0],X=z[1],Y=(0,a.useState)(null),J=Y[0],ee=Y[1],ne=(0,a.useState)(!0),re=ne[0],le=ne[1],ce=(0,a.useState)(!1),se=ce[0],fe=ce[1],de=(0,a.useRef)(!1),pe=(0,y.Z)(w.sel_province,V),ve=(0,f.m$)(c.M.WEATHER_FORECASTS,"ilocos",c.M.SUB_SEASONAL,"name"),me=ve.documents,he=ve.loading,ge=function(e,n){var t=(0,a.useState)(k),r=t[0],o=t[1];return(0,a.useEffect)((function(){if(void 0!==e.months&&n){var t,r,i,a,u,l=e.months.find((function(e){return e.mo===n.id})),c=Object.values(A.MW).find((function(e){return null!==(t=e.label===(null===l||void 0===l?void 0:l.con))&&void 0!==t?t:""}));o({forecast:null!==(r=null===l||void 0===l?void 0:l.con)&&void 0!==r?r:"",value:null!==(i=null===l||void 0===l?void 0:l.val)&&void 0!==i?i:0,label:null!==(a=null===c||void 0===c?void 0:c.sync)&&void 0!==a?a:"-",code:null!==(u=null===c||void 0===c?void 0:c.label)&&void 0!==u?u:"-"})}}),[e,n]),{forecast:r}}(T,w.sel_month),be=ge.forecast,ye=(0,b.Z)(w.sel_province,w.sel_crop),_e=ye.cropcalendar,Se=ye.cropStages,xe=ye.loading,we=O(w.sel_crop,C.code,"seasonal_sms"),Oe=we.recommendationsSMS,je=we.loading;(0,a.useEffect)((function(){var e;0!==(null===Oe||void 0===Oe?void 0:Oe.length)&&qe(Oe[0].sms.replace("{{seasonal_range_identifier}}",null===w||void 0===w||null===(e=w.sel_month)||void 0===e?void 0:e.label))}),[Oe,w.sel_month]),(0,a.useEffect)((function(){if(0!==_e.length&&!re&&0!==B.length&&null!==w.sel_municipality){var e=[];Object.values(_e).map((function(n){var t=n.find((function(e){return e.municipality===w.sel_municipality&&e.crop===w.sel_crop}));B.forEach((function(n){var r;if(t){var o=null===(r=t[n.id])||void 0===r?void 0:r.split(",");o&&2===(null===o||void 0===o?void 0:o.length)&&("none"===o[0]||e.includes(o[0])||e.push(o[0]),"none"===o[1]||e.includes(o[1])||e.push(o[1]))}}))}));var n=e.map((function(e,n){return{id:n,label:Se[e].label,code:e}}));ee(n)}}),[_e,re,w.sel_crop,w.sel_municipality,B,Se]);var Ee=(0,_.Z)().cropList.map((function(e,n){return{disabled:!1,label:e,id:n}})),Ae=(0,S.Z)(C.code,J,w.sel_crop,"seasonal",!0),ke=Ae.recommendations,Pe=Ae.farmoperations,Ie=Ae.loading,Re=(0,P.Z)(ke,Se,J).group,Ze=E(ke).group,Ce=(0,a.useState)(ue),Ne=Ce[0],Me=Ce[1],Te=(0,a.useState)(!1),Le=Te[0],De=Te[1],Be=(0,a.useState)(R.BF),Fe=Be[0],Ue=Be[1],He=(0,a.useState)(""),We=He[0],qe=He[1],Ge=(0,u.v9)((function(e){return e.dashboard.reportType})),$e=(0,u.I0)(),ze=(0,u.v9)((function(e){return e.reports})),Ve=ze.report,Xe=ze.status;(0,a.useEffect)((function(){var e;if((null===T||void 0===T||null===(e=T.months)||void 0===e?void 0:e.length)>0&&null!==w.sel_crop){N((0,g.Z)(T.months,"seasonal"));var n="".concat(A.re[T.mos[0].toUpperCase()].format," - ").concat(A.re[T.mos[5].toUpperCase()].format);j((function(e){return oe({},e,{sel_month:{label:n}})}))}}),[T,w.sel_crop]),(0,a.useEffect)((function(){de.current=!0;var e=function(){var e=te(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,l.$m)();case 3:n=e.sent,de&&X(n.data),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){de.current=!1}}),[]),(0,a.useEffect)((function(){$e((0,p.s_)())}),[$e]),(0,a.useEffect)((function(){V.length>0&&!he&&!r&&($((0,m.m)(V)),F(me[0].mos.reduce((function(e,n){return ie(e).concat([{id:A.re[n.toUpperCase()].code,label:A.re[n.toUpperCase()].format,disabled:!1}])}),[])))}),[V,me,he,r]),(0,a.useEffect)((function(){le(r||he||Ie||xe||je)}),[r,he,Ie,xe,je]),(0,a.useEffect)((function(){Xe===I.G.FULLFILLED&&null!==Ve&&de.current&&Ue((function(e){return oe({},e,{msg:Ve,loading:!1,savesuccess:!0,docId:Ve.id})}))}),[Xe,Ve]);var Ye=function(){var e=te(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ue(oe({},Fe,{loading:!0,msg:"Generating reports..."}));try{t={region:"ilocos",province:w.sel_province,crop:w.sel_crop,operation:"create",language:se?"tag":"en",isFull:!0},$e((0,v.Br)(t)).unwrap().then((function(){Ge!==R.Ry.SEASONAL&&($e((0,d.uq)(R.Ry.SEASONAL)),$e((0,v.RC)({uid:n.uid,type:R.Ry.SEASONAL})))})).catch((function(e){de.current&&Ue((function(n){return oe({},n,{msg:e,loading:!1,savesuccess:!1,docId:null})}))}))}catch(i){r="",void 0!==i.response&&(r=void 0!==i.response.data&&"[object Blob]"===((o=i.response.data)&&"undefined"!==typeof Symbol&&o.constructor===Symbol?"symbol":typeof o)?i.response.data:""),""===r&&(r=i)}case 2:case"end":return e.stop()}var o}),e)})));return function(){return e.apply(this,arguments)}}(),Je=function(){var e=te(o().mark((function e(){var n,t,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===Ne.url){e.next=3;break}return De(!0),e.abrupt("return");case 3:return j((function(e){return oe({},e,{loading:!0,error:"",success:""})})),e.prev=4,n={region:"ilocos",province:w.sel_province,municipality:w.sel_municipality,crop:w.sel_crop,operation:"preview",language:se?"tag":"en",isFull:!0},De(!0),j((function(e){return oe({},e,{loading:!0,error:""})})),e.next=10,(0,s.pl)(n);case 10:t=e.sent,r=new Blob([t],{type:"application/pdf"}),(i={}).href=URL.createObjectURL(r),i.download="".concat(w.sel_province,"_").concat(w.sel_municipality,"-(").concat(w.sel_crop,").pdf"),Me((function(e){return oe({},e,{url:i.href,filename:i.download})})),j((function(e){return oe({},e,{loading:!1,success:"Bulletin preview created."})})),e.next=25;break;case 19:return e.prev=19,e.t0=e.catch(4),e.next=23,(0,h.fu)(e.t0);case 23:a=e.sent,j((function(e){return oe({},e,{loading:!1,error:a})}));case 25:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsx)(K.Z,{loading:r,user:n,onBtnLogoutClick:t,accLevel:A.DW.ADMIN,children:(0,i.jsx)(Q,{climateRisk:C.label,optsprovinces:G,optsmunicipalities:pe,optscrops:Ee,optsmonths:B,optscropstages:J,optsactivities:Pe,sel_options:w,monthForecast:be,recommendations:Re,recommendationsImpacts:Ze,loading:re,isloadingreport:Xe===I.G.PENDING,open:Le,isTagalog:se,message:Fe,smstext:We,pdfPreview:Ne,onSelectItemChange:function(e,n){var t=n.from,r=n.label;if(Me(ue),H.length>0&&W([]),Object.keys(n).includes("id"))switch(t){case"province":ee(null),L(me.find((function(e){return e.name===r}))),j(oe({},ae,{sel_province:r}));break;case"crop":j(oe({},w,{sel_crop:r,sel_month:null,sel_stage:null,sel_activity:null}))}else"province"===t?(j(ae),ee(null)):"crop"===t?(j(oe({},w,{sel_crop:null,sel_month:null,sel_stage:null,sel_activity:null})),ee(null)):"month"===t&&(j(oe({},w,{sel_month:null,sel_stage:null,sel_activity:null})),ee(null))},handlePreview:Je,handleSave:Ye,toggleViewerOpen:function(){De((function(e){return!e}))},toggleGlobalLanguage:function(){fe((function(e){return!e})),Me(ue)},resetSelections:function(){j(ae),ee(null),W([])},togglePrompt:function(){Ue((function(e){return oe({},R.BF,{isOpen:!e.isOpen})}))}})})}))},59390:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(34051),o=t.n(r),i=t(67294),a=t(32848);function u(e,n,t,r,o,i,a){try{var u=e[i](a),l=u.value}catch(c){return void t(c)}u.done?n(l):Promise.resolve(l).then(r,o)}function l(e,n){var t=(0,i.useState)([]),r=t[0],l=t[1],c=(0,i.useState)([]),s=c[0],f=c[1],d=(0,i.useState)(!1),p=d[0],v=d[1],m=(0,i.useState)(""),h=m[0],g=m[1];return(0,i.useEffect)((function(){var t=function(){var t,r=(t=o().mark((function t(){var r,i,u,c,s,d,p;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,v(!0),t.next=4,(0,a.ad)(e,n);case 4:return r=t.sent,l(null!==(i=null===r||void 0===r?void 0:r.data)&&void 0!==i?i:[]),t.next=9,(0,a.Fj)(n);case 9:u=t.sent,f(null!==(c=null===u||void 0===u?void 0:u.data)&&void 0!==c?c:[]),v(!1),g(""),t.next=24;break;case 16:t.prev=16,t.t0=t.catch(0),p=null!==(d=null===t.t0||void 0===t.t0||null===(s=t.t0.response)||void 0===s?void 0:s.data)&&void 0!==d?d:t.t0.message,g(p),v(!1),l([]);case 24:case"end":return t.stop()}}),t,null,[[0,16]])})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){u(i,r,o,a,l,"next",e)}function l(e){u(i,r,o,a,l,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();e&&n&&(g(""),l([]),f([]),t())}),[e,n]),{cropcalendar:r,cropStages:s,loading:p,error:h}}},23766:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(67294);function o(e,n){var t=(0,r.useState)([]),o=t[0],i=t[1];return(0,r.useEffect)((function(){var t,r;i(e&&n&&null!==(r=null===(t=n.find((function(n){return n.label===e})))||void 0===t?void 0:t.municipalities)&&void 0!==r?r:[])}),[e,n]),o}},15497:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var r=t(67294);function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return o(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,n,t){var o=(0,r.useState)(null),a=o[0],u=o[1],l=(0,r.useState)(""),c=l[0],s=l[1];return(0,r.useEffect)((function(){if(s(""),(null===e||void 0===e?void 0:e.length)>0&&(null===t||void 0===t?void 0:t.length)>0&&n){var r=e.map((function(e){return e.farming_activity})).filter((function(e,n,t){return t.indexOf(e)===n})),o=null===t||void 0===t?void 0:t.map((function(e){return e.code}));try{u(o.reduce((function(t,o){return null===r||void 0===r||r.forEach((function(r){var a=n[o].label,u=e.filter((function(e){return e.crop_stage===o&&e.farming_activity===r}));u.length>0&&a&&(void 0===t[a]&&(t[a]={}),void 0===t[a][r]&&(t[a][r]=[]),t[a][r]=i(t[a][r]).concat(i(u)))})),t}),{}))}catch(a){u(null),s(a)}}else u(null)}),[e,n,t]),{group:a,error:c}}},22856:function(e,n,t){"use strict";t.d(n,{Z:function(){return f}});var r=t(34051),o=t.n(r),i=t(67294),a=t(9473),u=t(72216),l=t(1096);function c(e,n,t,r,o,i,a){try{var u=e[i](a),l=u.value}catch(c){return void t(c)}u.done?n(l):Promise.resolve(l).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){c(i,r,o,a,u,"next",e)}function u(e){c(i,r,o,a,u,"throw",e)}a(void 0)}))}}function f(e,n,t,r){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=arguments.length>5&&void 0!==arguments[5]&&arguments[5],d=(0,i.useState)([]),p=d[0],v=d[1],m=(0,i.useState)([]),h=m[0],g=m[1],b=(0,i.useState)(!1),y=b[0],_=b[1],S=(0,i.useState)(""),x=S[0],w=S[1],O=(0,a.I0)();return(0,i.useEffect)((function(){var i=function(){var i=s(o().mark((function i(){var a,s,d,p,m,h;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,a=[],_(!1),w(""),s=n,"object"===typeof n&&(s=n.map((function(e){return e.code}))),f){o.next=12;break}return o.next=9,(0,l.$K)({climateRisk:e,_cropStage:s,crop:t,type:r,multipleStages:c});case 9:a=o.sent,o.next=15;break;case 12:return o.next=14,(0,l.fI)({_cropStage:s,crop:t,type:r,multipleStages:c});case 14:a=o.sent;case 15:d=a.map((function(e){return e.farming_activity})).filter((function(e,n,t){return t.indexOf(e)===n})).reduce((function(e,n,t){return e.push({id:t,label:n}),e}),[]),_(!1),g(d),v(a||[]),O((0,u.lO)(a||[])),o.next=29;break;case 22:o.prev=22,o.t0=o.catch(0),h=null!==(m=null===o.t0||void 0===o.t0||null===(p=o.t0.response)||void 0===p?void 0:p.data)&&void 0!==m?m:o.t0.message,w(h),_(!1);case 29:case"end":return o.stop()}}),i,null,[[0,22]])})));return function(){return i.apply(this,arguments)}}();n&&t&&(null===n||void 0===n?void 0:n.length)>0?i():(v([]),g([]))}),[e,n,t,r,c,f,O]),{recommendations:p,farmoperations:h,loading:y,error:x}}},87682:function(e,n,t){"use strict";t.d(n,{ky:function(){return d},m$:function(){return p},tl:function(){return v}});var r=t(34051),o=t.n(r),i=t(67294),a=t(25321),u=t(96772);function l(e,n,t,r,o,i,a){try{var u=e[i](a),l=u.value}catch(c){return void t(c)}u.done?n(l):Promise.resolve(l).then(r,o)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){l(i,r,o,a,u,"next",e)}function u(e){l(i,r,o,a,u,"throw",e)}a(void 0)}))}}function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){s(e,n,t[n])}))}return e}function d(e,n){var t=(0,i.useState)(null),r=t[0],l=t[1],s=(0,i.useState)(!0),f=s[0],d=s[1],p=(0,i.useState)(""),v=p[0],m=p[1],h=(0,i.useRef)(!0);return(0,i.useEffect)((function(){var t=function(){var t=c(o().mark((function t(){var r,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=(0,a.JU)(u.db,e,n),t.next=4,(0,a.QT)(r);case 4:i=t.sent,h.current&&(i.exists()&&l(i.data()),d(!1)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),m(t.t0.message),d(!1);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return h.current=!1}}),[e,n]),[r,f,v]}function p(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=(0,i.useState)([]),s=l[0],d=l[1],p=(0,i.useState)(!0),v=p[0],m=p[1],h=(0,i.useState)(""),g=h[0],b=h[1],y=(0,i.useRef)(!0);return(0,i.useEffect)((function(){var i=function(){var i=c(o().mark((function i(){var l,c;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,l=(0,a.IO)((0,a.hJ)(u.db,e,n,t),(0,a.Xo)(r)),o.next=4,(0,a.PL)(l);case 4:c=o.sent,y.current&&(d(c.docs.map((function(e){return f({},e.data())}))),m(!1)),o.next=12;break;case 8:o.prev=8,o.t0=o.catch(0),b(o.t0.message),m(!1);case 12:case"end":return o.stop()}}),i,null,[[0,8]])})));return function(){return i.apply(this,arguments)}}();return i(),function(){return y.current=!1}}),[e,n,t,r]),{documents:s,loading:v,error:g}}function v(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4?arguments[4]:void 0,s=(0,i.useState)([]),d=s[0],p=s[1],v=(0,i.useState)(!0),m=v[0],h=v[1],g=(0,i.useState)(""),b=g[0],y=g[1],_=(0,i.useRef)(!0);return(0,i.useEffect)((function(){var i=function(){var i=c(o().mark((function i(){var c,s;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,c=(0,a.hJ)(u.db,e,n,t),""!==r&&(c=(0,a.IO)(c,(0,a.Xo)(r))),l&&(c=(0,a.IO)(c,(0,a.b9)(l))),o.next=6,(0,a.PL)(c);case 6:s=o.sent,_.current&&(p(s.docs.map((function(e){return f({},e.data())}))),h(!1)),o.next=14;break;case 10:o.prev=10,o.t0=o.catch(0),y(o.t0.message),h(!1);case 14:case"end":return o.stop()}}),i,null,[[0,10]])})));return function(){return i.apply(this,arguments)}}();return i(),function(){return _.current=!1}}),[e,n,t,r,l]),{documents:d,loading:m,error:b}}},87784:function(e,n,t){"use strict";t.d(n,{aS:function(){return i},fu:function(){return a}});var r=t(47426);function o(e,n){return null!=n&&"undefined"!==typeof Symbol&&n[Symbol.hasInstance]?n[Symbol.hasInstance](e):e instanceof n}var i=function(e){return e===r.nQ?r.DD:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return parseFloat(e).toFixed(n)}(e)},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return new Promise((function(n){if(void 0===e||"object"!==typeof e)n("Missing error response object");else{var t="";if(e.response)if(o(e.response.data,Blob)){var r=new Blob([e.response.data],{type:"application/octet-stream"}),i=new FileReader;i.onload=function(){var e=i.result;n(e)},i.readAsText(r)}else n("Error reading data");else e.request?(t=e.request,n(t)):(t=e.message,n(t))}}))}},59111:function(e,n,t){"use strict";t.d(n,{m:function(){return r}});var r=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"label";return e.map((function(e,t){return{id:t,label:e[n]}}))}},52955:function(e,n){"use strict";function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function r(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){if(0===e.length)return{};for(var n={wb_normal:[],b_normal:[],above_normal:[],near_normal:[]},t=e[0].con,o=1,i=1;i<e.length;i++)e[i].con===t?o++:(n[t].push(o),t=e[i].con,o=1);return n[t].push(o),function(e){var n,t,o,i,a,u,l=(null!==(i=null===e||void 0===e?void 0:e.b_normal.length)&&void 0!==i?i:0)>0?(n=Math).max.apply(n,r(e.b_normal)):void 0,c=(null!==(a=null===e||void 0===e?void 0:e.wb_normal.length)&&void 0!==a?a:0)>0?(t=Math).max.apply(t,r(e.wb_normal)):void 0,s=(null!==(u=null===e||void 0===e?void 0:e.above_normal.length)&&void 0!==u?u:0)>0?(o=Math).max.apply(o,r(e.above_normal)):void 0,f=void 0!==l&&5===l||void 0!==c&&3===c,d=void 0!==l&&l[0]>=3||void 0!==c&&2===c[0];return f?{label:"Drought",code:"drought"}:d?{label:"Dry Spell",code:"dry_spell"}:void 0!==l&&2===l?{label:"Dry Condition",code:"dry_condition"}:void 0!==s&&s>=3?{label:"Wetter Condition",code:"wetter_condition"}:{label:"No Risk",code:"no_risk"}}(n)}function i(e){if(0===e.length)return{};for(var n={"NO RAIN":[],"MODERATE RAINS":[],"HEAVY RAINS":[],"LIGHT RAINS":[]},t=e[0].rainfall,o=1,i=1;i<e.length;i++)e[i].rainfall===t?o++:(n[t].push(o),t=e[i].rainfall,o=1);return n[t].push(o),function(e){var n,t,o,i,a,u,l,c,s=(null!==(u=null===(i=e["MODERATE RAINS"])||void 0===i?void 0:i.length)&&void 0!==u?u:0)>0?(n=Math).max.apply(n,r(e["MODERATE RAINS"])):void 0,f=(null!==(l=null===(a=e["HEAVY RAINS"])||void 0===a?void 0:a.length)&&void 0!==l?l:0)>0?(t=Math).max.apply(t,r(e["HEAVY RAINS"])):void 0,d=(null!==(c=e["NO RAIN"].length)&&void 0!==c?c:0)>0?(o=Math).max.apply(o,r(e["NO RAIN"])):void 0;return void 0!==s&&s>=3?{label:"Flooding/Submergence 3M",code:"flooding_submergence_3M"}:void 0!==f&&f>=2?{label:"Flooding/Submergence 2H",code:"flooding_submergence_2H"}:void 0!==d&&10===d?{label:"Dry Condition",code:"dry_condition"}:{label:"No Risk",code:"no_risk"}}(n)}n.Z=function(e,n){switch(n){case"seasonal":return o(e);case"tenday":return i(e)}}}},function(e){e.O(0,[5778,2702,8858,8333,6223,6279,4597,7944,7067,1050,2044,3877,9774,2888,179],(function(){return n=40108,e(e.s=n);var n}));var n=e.O();_N_E=n}]);