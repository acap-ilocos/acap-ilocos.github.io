(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9639],{54599:function(e,n,t){"use strict";var r=t(64836);n.Z=void 0;var i=r(t(64938)),a=t(85893),o=(0,i.default)((0,a.jsx)("path",{d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2h-3zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8h-3zM5 19l3-4 2 3 3-4 4 5H5z"}),"AddPhotoAlternate");n.Z=o},50594:function(e,n,t){"use strict";var r=t(64836);n.Z=void 0;var i=r(t(64938)),a=t(85893),o=(0,i.default)((0,a.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");n.Z=o},95537:function(e,n,t){"use strict";var r=t(88169),i=t(85893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},67070:function(e,n,t){"use strict";t(67294);var r=t(88169),i=t(85893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},56686:function(e,n,t){"use strict";t(67294);var r=t(88169),i=t(85893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},42176:function(e,n,t){"use strict";t.d(n,{D:function(){return m}});var r=t(87462),i=t(63366),a=t(67294),o=t(86010),l=t(11496),s=t(27192),c=t(73490),u=t(48836),d=t(85893);const p=["className","children"],f=(0,l.ZP)("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(e,n)=>n.toolbarContainer})((({theme:e})=>({display:"flex",alignItems:"center",padding:e.spacing(.5,.5,0)}))),m=a.forwardRef((function(e,n){const{className:t,children:a}=e,l=(0,i.Z)(e,p),m=(e=>{const{classes:n}=e;return(0,s.Z)({root:["toolbarContainer"]},c.d,n)})({classes:(0,u.B)().classes});return a?(0,d.jsx)(f,(0,r.Z)({ref:n,className:(0,o.Z)(t,m.root)},l,{children:a})):null}))},6132:function(e,n,t){"use strict";t.d(n,{S:function(){return f}});var r=t(87462),i=t(63366),a=t(67294),o=t(14696),l=t(10269),s=t(27476),c=t(49630),u=t(48836),d=t(85893);const p=["onClick"],f=a.forwardRef((function(e,n){var t;const{onClick:a}=e,f=(0,i.Z)(e,p),m=(0,c.l)(),v=(0,u.B)(),{open:h,openedPanelValue:g}=(0,o.P)(m,l.e);return v.disableColumnSelector?null:(0,d.jsx)(v.components.BaseButton,(0,r.Z)({ref:n,size:"small",color:"primary","aria-label":m.current.getLocaleText("toolbarColumnsLabel"),startIcon:(0,d.jsx)(v.components.ColumnSelectorIcon,{})},f,{onClick:e=>{h&&g===s.y.columns?m.current.hidePreferences():m.current.showPreferences(s.y.columns),null==a||a(e)}},null==(t=v.componentsProps)?void 0:t.baseButton,{children:m.current.getLocaleText("toolbarColumns")}))}))},50853:function(e,n,t){"use strict";t.d(n,{M:function(){return j}});var r=t(87462),i=t(63366),a=t(67294),o=t(11496),l=t(27192),s=t(88082),c=t(98216),u=t(90198),d=t(14696),p=t(61207),f=t(10269),m=t(27476),v=t(49630),h=t(48836),g=t(73490),b=t(85893);const y=["componentsProps"],x=(0,o.ZP)("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(e,n)=>n.toolbarFilterList})((({theme:e})=>({margin:e.spacing(1,1,.5),padding:e.spacing(0,1)}))),j=a.forwardRef((function(e,n){var t,o;const{componentsProps:j={}}=e,Z=(0,i.Z)(e,y),_=j.button||{},w=(0,v.l)(),S=(0,h.B)(),C=(0,d.P)(w,p.DY),k=(0,d.P)(w,u.WH),P=(0,d.P)(w,f.e),A=(e=>{const{classes:n}=e;return(0,l.Z)({root:["toolbarFilterList"]},g.d,n)})({classes:S.classes}),O=a.useMemo((()=>{if(P.open)return w.current.getLocaleText("toolbarFiltersTooltipHide");if(0===C.length)return w.current.getLocaleText("toolbarFiltersTooltipShow");const e=e=>k[e.columnField].filterOperators.find((n=>n.value===e.operatorValue)).label||w.current.getLocaleText(`filterOperator${(0,c.Z)(e.operatorValue)}`).toString();return(0,b.jsxs)("div",{children:[w.current.getLocaleText("toolbarFiltersTooltipActive")(C.length),(0,b.jsx)(x,{className:A.root,children:C.map(((n,t)=>(0,r.Z)({},k[n.columnField]&&(0,b.jsx)("li",{children:`${k[n.columnField].headerName||n.columnField}\n                  ${e(n)}\n                  ${n.value}`},t))))})]})}),[w,P.open,C,k,A]);return S.disableColumnFilter?null:(0,b.jsx)(S.components.BaseTooltip,(0,r.Z)({title:O,enterDelay:1e3},Z,null==(t=S.componentsProps)?void 0:t.baseTooltip,{children:(0,b.jsx)(S.components.BaseButton,(0,r.Z)({ref:n,size:"small",color:"primary","aria-label":w.current.getLocaleText("toolbarFiltersLabel"),startIcon:(0,b.jsx)(s.Z,{badgeContent:C.length,color:"primary",children:(0,b.jsx)(S.components.OpenFilterButtonIcon,{})})},_,{onClick:e=>{var n;const{open:t,openedPanelValue:r}=P;t&&r===m.y.filters?w.current.hideFilterPanel():w.current.showFilterPanel(),null==(n=_.onClick)||n.call(_,e)}},null==(o=S.componentsProps)?void 0:o.baseButton,{children:w.current.getLocaleText("toolbarFilters")}))}))}))},41397:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/villages",function(){return t(97461)}])},53577:function(e,n,t){"use strict";var r=t(85893),i=t(87357),a=t(98456);n.Z=function(e){var n=e.text,t=void 0===n?"":n,o=e.size,l=void 0===o?24:o,s=e.children;return(0,r.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",height:"18vh"},children:[(0,r.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",marginTop:function(e){return e.spacing(6)},marginBottom:"32px",display:"flex",justifyContent:"center"},children:[(0,r.jsx)("span",{children:""!==t?t:"Loading..."})," \xa0",(0,r.jsx)(a.Z,{size:l})]}),s]})}},19227:function(e,n,t){"use strict";t.d(n,{Z:function(){return Z}});var r=t(85893),i=t(67294),a=t(45697),o=t.n(a),l=t(11057),s=t(98456),c=t(50657),u=t(31425),d=t(37645),p=t(6514),f=t(93946),m={button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal","& .text":{display:{xs:"block",sm:"none"}},"& .shortText":{display:{xs:"inline-block",sm:"none"},fontSize:"24px"}},icon:{display:{xs:"block",sm:"none"}},dialogContent:{"& .error":{fontSize:"12px",color:"red"}},dialogActions:{"& button":{minWidth:"100px"}},closeButton:{position:"absolute",right:"8px",top:"8px",color:function(e){return e.palette.grey[500]}}},v=t(95537),h=t(87357);function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function b(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){b(e,n,t[n])}))}return e}function x(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,a=[],o=!0,l=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);o=!0);}catch(s){l=!0,i=s}finally{try{o||null==t.return||t.return()}finally{if(l)throw i}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return g(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e){var n=x(i.useState({open:null}),2),t=n[0],a=n[1],o=e.loading,g=void 0!==o&&o,b=e.isOpen,j=void 0!==b&&b,Z=e.showButtons,_=void 0===Z||Z,w=e.maxWidth,S=void 0===w?"sm":w,C=e.IconSVG,k=void 0===C?null:C,P=e.modalButtonStyles,A=void 0===P?{}:P,O=e.modalExtraHandlerCB,E=void 0===O?null:O,B=e.modalCancelHandlerCB,T=void 0===B?null:B,I=e.modalConfirmHandlerCB,M=void 0===I?null:I,N=e.modalOpenHandlerCB,F=void 0===N?null:N,L=e.isDisabled,z=void 0!==L&&L,D=e.yesIsDisabled,R=void 0!==D&&D,W=e.progress,H=void 0===W?0:W,V=e.openBtnVariant,G=void 0===V?null:V,U=e.openButtonText,$=void 0===U?"Click":U,J=e.title,X=void 0===J?"Window Title":J,Y=e.extraBtnText,K=void 0===Y?"":Y,Q=e.cancelBtnText,q=void 0===Q?"Cancel":Q,ee=e.confirmBtnText,ne=void 0===ee?"Ok":ee,te=e.contentText,re=void 0===te?"":te,ie=e.error,ae=void 0===ie?"":ie,oe=e.colorTheme,le=void 0===oe?"primary":oe;(0,i.useEffect)((function(){a((function(e){return y({},e,{open:j})}))}),[j]);var se=function(){a(y({},t,{open:!1})),T&&T()};return(0,r.jsxs)("div",{children:[$&&(0,r.jsxs)(l.Z,{disabled:z,disableElevation:!0,variant:"".concat(G||"contained"),color:le,onClick:function(){a(y({},t,{open:!0})),F&&F()},sx:y({},m.button,A),children:[k&&(0,r.jsx)(k,{sx:m.icon}),$]}),(0,r.jsxs)(c.Z,{maxWidth:S,fullWidth:!0,open:t.open||!1,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,r.jsxs)(d.Z,{children:[(0,r.jsx)("span",{children:X}),(0,r.jsx)(f.Z,{"aria-label":"close",sx:m.closeButton,onClick:se,disabled:g,children:(0,r.jsx)(v.Z,{})})]}),(0,r.jsxs)(p.Z,{sx:m.dialogContent,children:[""!==re&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:re}),(0,r.jsx)("div",{className:"error",children:ae})]}),e.children]}),_&&(0,r.jsxs)(u.Z,{sx:m.dialogActions,children:[""!==K&&(0,r.jsx)(l.Z,{onClick:E||se,disabled:g,children:K}),(0,r.jsx)(l.Z,{onClick:T||se,disabled:g,children:q}),(0,r.jsxs)(l.Z,{variant:"contained",disabled:g||R,onClick:M||se,children:[(0,r.jsx)("span",{style:{display:g?"none":"block"},children:ne}),g&&0===H&&(0,r.jsx)(h.Z,{children:(0,r.jsx)(s.Z,{size:24,color:"secondary",sx:{display:g?"block":"none"}})}),g&&H>0&&(0,r.jsx)(h.Z,{children:(0,r.jsx)(s.Z,{size:24,color:"primary",variant:"determinate",value:H})})]})]})]})]})}j.propTypes={loading:o().bool,isOpen:o().bool,showButtons:o().bool,maxWidth:o().string,IconSVG:o().elementType,modalButtonStyles:o().object,modalCancelHandlerCB:o().func,modalConfirmHandlerCB:o().func,modalOpenHandlerCB:o().func,modalExtraHandlerCB:o().func,openButtonText:o().string,cancelBtnText:o().string,confirmBtnText:o().string,extraBtnText:o().string,title:o().string,contentText:o().string,children:o().node,error:o().string,isDisabled:o().bool,colorTheme:o().string};var Z=j},89646:function(e,n,t){"use strict";var r=t(85893),i=t(55113);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var o=(0,t(11496).ZP)((function(e){return(0,r.jsx)(i.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){a(e,n,t[n])}))}return e}({},e))}))((function(e){var n=e.theme;return{padding:n.spacing(3),borderRadius:n.spacing(1),backgroundColor:"#fff",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",border:"1px solid ".concat(n.palette.bacap.border)}}));n.Z=o},55688:function(e,n,t){"use strict";var r=t(85893),i=t(67294),a=t(45697),o=t.n(a),l=t(14866),s=t(46901);function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var u=i.forwardRef((function(e,n){return(0,r.jsx)(s.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){c(e,n,t[n])}))}return e}({elevation:6,ref:n,variant:"filled"},e))}));function d(e){var n=e.openSnackbar,t=e.message,a=e.severity,o=e.closeHandlerCB,s=void 0===o?function(){}:o,c=(0,i.useState)(n),d=c[0],p=c[1];(0,i.useEffect)((function(){p(n)}),[n]);var f=function(){p(!1),s()};return(0,r.jsx)(l.Z,{open:d,autoHideDuration:3e3,onClose:f,children:(0,r.jsx)(u,{onClose:f,severity:a,sx:{width:"100%"},children:t})})}d.propTypes={openSnackbar:o().bool,message:o().string,severity:o().string},n.Z=d},97461:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return je}});var r=t(85893),i=t(67294),a=t(9473),o=t(95243),l=t(66383),s=t(47426),c=t(901),u=t(55688),d=t(34051),p=t.n(d),f=t(87357),m=t(89646),v=t(15861),h=t(42176),g=t(6132),b=t(50853),y=t(24343),x=t(11057),j=t(50657),Z=t(37645),_=t(93946),w=t(6514),S=t(61903),C=t(94054),k=t(47312),P=t(18360),A=t(18972),O=t(50480),E=t(69368),B=t(86886),T=t(31425),I=t(50594),M=t(5152),N=t(9669),F=t.n(N),L=t(53577);function z(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function D(e,n,t,r,i,a,o){try{var l=e[a](o),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function R(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function W(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){R(e,n,t[n])}))}return e}function H(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,a=[],o=!0,l=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);o=!0);}catch(s){l=!0,i=s}finally{try{o||null==t.return||t.return()}finally{if(l)throw i}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return z(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return z(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var V=(0,M.default)((function(){return Promise.all([t.e(9269),t.e(6133)]).then(t.bind(t,66133)).then((function(e){return e.MapContainer}))}),{loadableGenerated:{webpack:function(){return[66133]}},ssr:!1}),G=(0,M.default)((function(){return Promise.all([t.e(9269),t.e(6133)]).then(t.bind(t,66133)).then((function(e){return e.TileLayer}))}),{loadableGenerated:{webpack:function(){return[66133]}},ssr:!1}),U=(0,M.default)((function(){return Promise.all([t.e(9269),t.e(6133)]).then(t.bind(t,66133)).then((function(e){return e.GeoJSON}))}),{loadableGenerated:{webpack:function(){return[66133]}},ssr:!1}),$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#2e7d32";return"\n<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='32' height='32'>\n    <path fill='".concat(e,"' d='M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5z'/>\n</svg>")},J=function(e){var n=e.open,a=e.onClose,o=e.onConfirm,l=e.extAddress,s=e.coordinates,c=(0,i.useRef)(null),u=(0,i.useRef)(!1),d=(0,i.useRef)(null),m=(0,i.useRef)(null),h=(0,i.useRef)(!0),g=(0,i.useState)(!1),b=g[0],y=g[1],S=(0,i.useState)({barangay:"",municipality:"",province:""}),C=S[0],k=S[1],P=(0,i.useState)(!1),A=P[0],O=P[1],E=(0,i.useState)(!1),B=E[0],M=E[1],N=(0,i.useState)(!1),z=N[0],R=N[1],J=(0,i.useState)(null),X=J[0],Y=J[1];(0,i.useEffect)((function(){return function(){h.current=!1}}),[]),(0,i.useEffect)((function(){t.e(9269).then(t.t.bind(t,45243,23)).then((function(e){return Y(e&&e.default?e.default:e)}))}),[]),(0,i.useEffect)((function(){t.e(5729).then(t.t.bind(t,65729,23))}),[]),(0,i.useEffect)((function(){var e=!1,n=function(){var n,t=(n=p().mark((function n(){var t,r;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t="https://firebasestorage.googleapis.com/v0/b/region1-dev.appspot.com/o/geojson%2Fbarangays-2025.geojson?alt=media&token=d7db3a0b-c000-40a1-8937-589e71327bc5"){n.next=5;break}return console.error("No barangays geojson URL configured"),n.abrupt("return");case 5:return n.next=7,F().get(t);case 7:r=n.sent,!e&&h.current&&R(r.data),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),console.error("error loading barangays geojson: ",n.t0&&n.t0.message?n.t0.message:n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})),function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){D(a,r,i,o,l,"next",e)}function l(e){D(a,r,i,o,l,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return n(),function(){e=!0}}),[]),(0,i.useEffect)((function(){n&&c.current&&setTimeout((function(){c.current.invalidateSize()}),100)}),[n]);(0,i.useEffect)((function(){if(n&&B&&z&&s&&!u.current){var e=H(s,2),t=e[0],r=e[1];if(""!==t&&""!==r&&null!=t&&null!=r){var i;try{i=setTimeout((function(){var e;if(h.current){var n=X.latLng(Number(t),Number(r));null===(e=c.current)||void 0===e||e.setView(n,15);var i=function(e,n){if(!(null===n||void 0===n?void 0:n.features))return null;var t=e.lng,r=e.lat,i=!0,a=!1,o=void 0;try{for(var l,s=n.features[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value,u=c.geometry;if(u){var d,p,f,m=u.type,v=u.coordinates,h=!1;if("Polygon"===m?h=Q(t,r,v):"MultiPolygon"===m&&(h=v.some((function(e){return Q(t,r,e)}))),h)return{NAME_3:(null===(d=c.properties)||void 0===d?void 0:d.NAME_3)||"",NAME_2:(null===(p=c.properties)||void 0===p?void 0:p.NAME_2)||"",NAME_1:(null===(f=c.properties)||void 0===f?void 0:f.NAME_1)||""}}}}catch(g){a=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return null}(n,z)||null;ee(n,i),h.current&&y(!0),u.current=!0}}),50)}catch(a){console.error("auto marker error:",a)}return function(){i&&clearTimeout(i)}}}}),[n,B,s,l,z]);var K=function(e,n,t){for(var r=!1,i=0,a=t.length-1;i<t.length;a=i++){var o=t[i][0],l=t[i][1],s=t[a][0],c=t[a][1];l>n!==c>n&&e<(s-o)*(n-l)/(c-l)+o&&(r=!r)}return r},Q=function(e,n,t){if(!t||!t.length)return!1;if(!K(e,n,t[0]))return!1;for(var r=1;r<t.length;r++)if(K(e,n,t[r]))return!1;return!0},q=function(e,n){if(!n)return!1;var t=e.lng,r=e.lat,i=function(e){if(!Array.isArray(e))return!1;var n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var s=o.value;if(s&&s.geometry){var c=s.geometry.type,u=s.geometry.coordinates;if(u)if("Polygon"===c){if(Q(t,r,u))return!0}else if("MultiPolygon"===c){var d=!0,p=!1,f=void 0;try{for(var m,v=u[Symbol.iterator]();!(d=(m=v.next()).done);d=!0){var h=m.value;if(Q(t,r,h))return!0}}catch(g){p=!0,f=g}finally{try{d||null==v.return||v.return()}finally{if(p)throw f}}}}}}catch(g){i=!0,a=g}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return!1};if("FeatureCollection"===n.type&&Array.isArray(n.features))return i(n.features);if("Feature"===n.type&&n.geometry)return i([n]);if(Array.isArray(n.features))return i(n.features);if(Array.isArray(n))return i(n);if(n.barangays){var a=Array.isArray(n.barangays.features)?n.barangays.features:Array.isArray(n.barangays)?n.barangays:null;if(a&&i(a))return!0}if(n.municipalities){var o=Array.isArray(n.municipalities.features)?n.municipalities.features:Array.isArray(n.municipalities)?n.municipalities:null;if(o&&i(o))return!0}return!1},ee=function(e,n){if(c.current&&c.current.getPane("markerPane"))try{if(!c.current||!e)return;if(d.current){try{c.current.removeLayer(d.current)}catch(o){}d.current=null}var t=X.divIcon({className:"room-div-icon",html:$("#c52121"),iconSize:[32,32],iconAnchor:[14,28]}),r=X.marker(e,{icon:t});r.addTo(c.current);var i=n&&null!==n.NAME_3?"".concat(n.NAME_3,", ").concat(n.NAME_2,", ").concat(n.NAME_1," (").concat(e.lat.toFixed(6),", ").concat(e.lng.toFixed(6),")"):"Outside of Region 1 (".concat(e.lat.toFixed(6),", ").concat(e.lng.toFixed(6),")");r.bindTooltip(i,{permanent:!0,direction:"bottom",className:"map-selected-tooltip"}).openTooltip(),d.current=r,u.current=!0,k((function(e){return W({},e,{barangay:n&&n.NAME_3?n.NAME_3:"",municipality:n&&n.NAME_2?n.NAME_2:"",province:n&&n.NAME_1?n.NAME_1:""})})),h.current&&y(!0);try{var a=q(e,z);h.current&&O(!a)}catch(o){h.current&&O(!1)}}catch(l){console.error(l)}},ne=function(){try{if(k((function(e){return W({},e,{barangay:"",municipality:"",province:""})})),d.current&&c.current)try{c.current.removeLayer(d.current)}catch(e){}}catch(n){}d.current=null,u.current=!1,O(!1)},te=function(){try{ne()}catch(e){}try{c.current&&m.current&&(c.current.off("click",m.current),m.current=null)}catch(n){}a&&a()};return(0,i.useEffect)((function(){try{if(d.current&&h.current){var e=d.current.getLatLng(),n=q(e,z);h.current&&O(!n)}}catch(t){}}),[z]),(0,r.jsxs)(j.Z,{open:n,onClose:te,maxWidth:"lg",fullWidth:!0,children:[(0,r.jsx)(Z.Z,{children:(0,r.jsxs)(f.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)(v.Z,{variant:"h6",children:"Select Location on Map"}),(0,r.jsx)(_.Z,{"aria-label":"close",onClick:te,children:(0,r.jsx)(I.Z,{})})]})}),(0,r.jsx)(w.Z,{sx:{height:"60vh",p:0},children:z?(0,r.jsxs)(V,{zoom:9,minZoom:2,center:[16.609289,120.318616],whenCreated:function(e){c.current=e;var n=function(e){u.current||e&&e.latlng&&ee(e.latlng)};e.on("click",n),m.current=n,h.current&&M(!0)},style:{height:"100%",width:"100%"},children:[(0,r.jsx)(G,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,r.jsx)(U,{data:z,eventHandlers:{click:function(e){u.current||e&&e.latlng&&ee(e.latlng)}},onEachFeature:function(e,n){var t=null,r=e.properties;n.on("mousemove",(function(e){try{if(u.current)return;if(!c.current)return;var n=e.latlng;if(!n)return;var i=r?"".concat(r.NAME_3,", ").concat(r.NAME_2,", ").concat(r.NAME_1," (").concat(n.lat.toFixed(6),", ").concat(n.lng.toFixed(6),")"):"Outside of Region 1 (".concat(n.lat.toFixed(6),", ").concat(n.lng.toFixed(6),")");t||(t=X.tooltip({permanent:!1,direction:"top",className:"map-mouse-tooltip"})),t.setLatLng(n).setContent(i),t._map||t.addTo(c.current)}catch(a){}})),n.on("mouseout",(function(){try{t&&t._map&&c.current&&c.current.removeLayer(t)}catch(e){}t=null})),n.on("click",(function(e){u.current||e&&e.latlng&&(ee(e.latlng,r),h.current&&y(!0))}))}})]}):(0,r.jsx)(f.Z,{sx:{p:2},children:(0,r.jsx)(L.Z,{})})}),(0,r.jsxs)(T.Z,{children:[(0,r.jsx)(x.Z,{variant:"outlined",color:"error",onClick:function(){ne(),h.current&&(y(!1),O(!1))},disabled:!b,children:"Remove"}),(0,r.jsx)(x.Z,{variant:"contained",color:"primary",onClick:function(){try{if(d.current){var e=d.current.getLatLng();o&&o({lat:e.lat,lon:e.lng,barangay:C.barangay||null,municipality:C.municipality||null,province:C.province||null})}}catch(n){}h.current&&y(!1),te()},disabled:!b||A,children:"Confirm"})]})]})},X=(0,M.default)((function(){return Promise.resolve(J)}),{ssr:!1}),Y=t(60304),K=t(19227),Q=t(54599);function q(e){var n=e.onFileSelect,t=e.resetTrigger,a=e.initialPreviewUrl,o=void 0===a?null:a,l=e.onRemove,s=(0,i.useState)(null),c=s[0],u=s[1],d=(0,i.useState)(!1),p=d[0],m=d[1],h=(0,i.useRef)(null);(0,i.useEffect)((function(){u(null),m(!1),n(null),h.current&&(h.current.value="")}),[t,n]);var g=function(e){e&&(e.type.startsWith("image/")?(m(!1),u(URL.createObjectURL(e)),n(e)):alert("Only image files allowed"))},b=c||!p&&o||null;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{onClick:function(){return h.current.click()},onDragOver:function(e){return e.preventDefault()},onDrop:function(e){e.preventDefault(),g(e.dataTransfer.files[0])},sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",minHeight:200,border:"1px dashed grey",borderRadius:2,cursor:"pointer",overflow:"hidden"},children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{component:"img",src:b,sx:{width:"100%",height:"100%",objectFit:"cover"}}),(0,r.jsx)(_.Z,{onClick:function(e){e.stopPropagation(),u(null),m(!0),n(null),null===l||void 0===l||l()},size:"small",sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0,0,0,0.4)",color:"white","&:hover":{bgcolor:"rgba(0,0,0,0.6)"}},children:(0,r.jsx)(I.Z,{})})]}):(0,r.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",opacity:.5},children:[(0,r.jsx)(x.Z,{variant:"text",color:"primary",startIcon:(0,r.jsx)(Q.Z,{}),children:"Upload"}),(0,r.jsx)(v.Z,{variant:"subtitle2",children:"Click or drag an image to upload"})]})}),(0,r.jsx)("input",{type:"file",accept:"image/*",hidden:!0,ref:h,onChange:function(e){g(e.target.files[0])}})]})}function ee(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ne(e,n,t,r,i,a,o){try{var l=e[a](o),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function te(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function re(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){te(e,n,t[n])}))}return e}function ie(e){return function(e){if(Array.isArray(e))return ee(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return ee(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ee(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ae=function(e){var n=e.onClose,t=e.onSuccess,a=e.crops,o=e.provinces,l=(0,i.useState)({association:"",barangay:"",municipality:"",province:"",lat:"",lon:"",phase:"",commodities:[],total_land_area:"",total_members:0,climate_risks:""}),s=l[0],c=l[1],d=(0,i.useState)(null),m=d[0],h=d[1],g=(0,i.useState)(null),b=g[0],y=g[1],M=(0,i.useState)([]),N=M[0],F=M[1],L=(0,i.useState)([]),z=L[0],D=L[1],R=(0,i.useState)(!1),W=R[0],H=R[1],V=(0,i.useState)(!1),G=V[0],U=V[1],$=(0,i.useState)(!1),J=$[0],Q=$[1],ee=(0,i.useState)({message:"",severity:""}),ae=ee[0],oe=ee[1],le=["High Value Crops","Vegetables","Low-land Vegetables","Swine","Cattle","Goat","Poultry","Fish"],se=(0,i.useState)(!1),ce=se[0],ue=se[1],de=function(e){var n=e.target,t=n.id,r=n.value,i=n.name;if(c((function(e){return re({},e,te({},t,r))})),void 0!==i&&"phase"!==i)switch(i){case"province":var a;F([]),D([]),c((function(e){return re({},e,{province:r,municipality:"",barangay:""})})),F((null===(a=o.find((function(e){return e.label===r})))||void 0===a?void 0:a.municipalities)||[]);break;case"municipality":var l;D([]),c((function(e){return re({},e,{municipality:r,barangay:""})})),D((null===(l=N.find((function(e){return e.label===r})))||void 0===l?void 0:l.barangays)||[]);break;case"barangay":c((function(e){return re({},e,{barangay:r})}))}"phase"===i&&c((function(e){return re({},e,{phase:r})}))},pe=function(e,n){c((function(t){var r=t.commodities||[];return re({},t,{commodities:n?ie(r).concat([e]):r.filter((function(n){return n!==e}))})}))},fe=function(){c({association:"",barangay:"",municipality:"",province:"",lat:"",lon:"",phase:"",commodities:[],total_land_area:"",total_members:0,climate_risks:""}),h(null),y((function(e){return!e}))},me=function(){var e,n=(e=p().mark((function e(n,r){var i,a,o,l,c,u,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ue(!0),e.prev=1,(i=new FormData).append("association",n.association),i.append("lat",n.lat),i.append("lon",n.lon),i.append("province",n.province),i.append("municipality",n.municipality),i.append("barangay",n.barangay),i.append("phase",n.phase||""),i.append("commodities",JSON.stringify(n.commodities||[])),i.append("total_land_area",n.total_land_area||""),i.append("total_members",String(null!==(a=n.total_members)&&void 0!==a?a:"")),i.append("climate_risks",n.climate_risks||""),r&&(o=(new Date).toISOString().slice(0,10),l=r.name.split(".").pop()||"jpg",c=s.association.replace(/ /g,"_"),u="".concat(c,"_").concat(o,".").concat(l),i.append("image",r,u)),e.next=18,(0,Y.XO)(i);case 18:d=e.sent,ue(!1),oe({message:d.message||"Successfully created village.",severity:"success"}),Q(!0),fe(),setTimeout((function(){Q(!1),t()}),1500),e.next=33;break;case 26:e.prev=26,e.t0=e.catch(1),ue(!1),oe({message:(null===e.t0||void 0===e.t0||null===(f=e.t0.response)||void 0===f?void 0:f.data)||"Failed to create village.",severity:"error"}),Q(!0),setTimeout((function(){Q(!1)}),2e3);case 33:case"end":return e.stop()}}),e,null,[[1,26]])})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){ne(a,r,i,o,l,"next",e)}function l(e){ne(a,r,i,o,l,"throw",e)}o(void 0)}))});return function(e,t){return n.apply(this,arguments)}}(),ve=s.association&&s.lat&&s.lon&&s.province&&s.municipality&&s.barangay;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(j.Z,{open:!0,sx:{borderRadius:3},onClose:n,children:[(0,r.jsx)(Z.Z,{children:(0,r.jsx)(f.Z,{children:(0,r.jsx)(v.Z,{variant:"h5",children:"Create AMIA Village"})})}),(0,r.jsx)(_.Z,{"aria-label":"close",onClick:n,sx:{position:"absolute",right:8,top:8},children:(0,r.jsx)(I.Z,{})}),(0,r.jsxs)(w.Z,{divider:!0,sx:{minWidth:"64vh",minHeight:"60vh"},children:[(0,r.jsx)(q,{onFileSelect:h,resetTrigger:b}),(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Basic Information"})}),(0,r.jsx)(S.Z,{id:"association",name:"association",size:"small",label:"Association",value:s.association,onChange:de,fullWidth:!0,sx:{marginBottom:1}}),(0,r.jsxs)(f.Z,{sx:{display:"flex",gap:1},children:[(0,r.jsx)(S.Z,{id:"total_members",name:"total_members",size:"small",type:"number",label:"Total Members",value:s.total_members,onChange:de,fullWidth:!0,sx:{marginBottom:1}}),(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Phase"}),(0,r.jsxs)(P.Z,{name:"phase",value:s.phase,label:"phase",onChange:de,children:[(0,r.jsx)(A.Z,{value:"Phase I",children:"Phase I"}),(0,r.jsx)(A.Z,{value:"Phase II",children:"Phase II"}),(0,r.jsx)(A.Z,{value:"Phase III",children:"Phase III"}),(0,r.jsx)(A.Z,{value:"Phase IV",children:"Phase IV"})]})]})]}),(0,r.jsxs)(f.Z,{sx:{width:"100%",borderTop:"1px dashed grey"},children:[(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Commodities"})}),(0,r.jsxs)(f.Z,{children:[null===a||void 0===a?void 0:a.map((function(e){return(0,r.jsx)(O.Z,{control:(0,r.jsx)(E.Z,{checked:s.commodities.includes(e),onChange:function(n){return pe(e,n.target.checked)}}),label:e},e)})),null===le||void 0===le?void 0:le.map((function(e){return(0,r.jsx)(O.Z,{control:(0,r.jsx)(E.Z,{checked:s.commodities.includes(e),onChange:function(n){return pe(e,n.target.checked)}}),label:e},e)}))]})]}),(0,r.jsxs)(f.Z,{sx:{paddingBlock:1,width:"100%",borderBlock:"1px dashed grey"},children:[(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Location"})}),(0,r.jsx)(B.ZP,{container:!0,gap:2,sx:{paddingBottom:2,alignItems:"center"},children:(0,r.jsx)(B.ZP,{size:2,children:(0,r.jsx)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:(0,r.jsxs)(B.ZP,{container:!0,gap:1,children:[(0,r.jsx)(B.ZP,{item:!0,md:4,xs:12,children:(0,r.jsx)(S.Z,{id:"lat",size:"small",label:"Latitude",value:s.lat,onChange:de,fullWidth:!0})}),(0,r.jsx)(B.ZP,{item:!0,md:4,xs:12,children:(0,r.jsx)(S.Z,{id:"lon",size:"small",label:"Longitude",value:s.lon,onChange:de,fullWidth:!0})}),(0,r.jsx)(B.ZP,{item:!0,md:3,xs:12,children:(0,r.jsx)(x.Z,{variant:"contained",color:"primary",onClick:function(){return H(!0)},children:"Open Map"})})]})})})}),(0,r.jsxs)(B.ZP,{container:!0,gap:2,px:{width:"100%"},children:[(0,r.jsx)(B.ZP,{item:!0,md:3,xs:12,px:{width:"100%"},children:(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Province"}),(0,r.jsx)(P.Z,{name:"province",value:s.province,label:"province",onChange:de,children:o.map((function(e){return(0,r.jsx)(A.Z,{value:e.label,children:e.label},e.label)}))})]})}),(0,r.jsx)(B.ZP,{item:!0,md:4,xs:12,px:{width:"100%"},children:(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Municipality"}),(0,r.jsx)(P.Z,{name:"municipality",value:s.municipality,label:"municipality",onChange:de,children:N.map((function(e){return(0,r.jsx)(A.Z,{value:e.label,children:e.label},e.label)}))})]})}),(0,r.jsx)(B.ZP,{item:!0,md:3,xs:12,children:(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Barangay"}),(0,r.jsx)(P.Z,{name:"barangay",value:s.barangay,label:"barangay",onChange:de,children:z.map((function(e){return(0,r.jsx)(A.Z,{value:e.label,children:e.label},e.label)}))})]})})]}),(0,r.jsx)(S.Z,{id:"total_land_area",name:"total_land_area",type:"number",size:"small",label:"Total Land Area (ha)",value:s.total_land_area,onChange:de,fullWidth:!0,sx:{marginBottom:1}})]}),(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Climate-Related Risks/Hazards"})}),(0,r.jsx)(S.Z,{id:"climate_risks",name:"climate_risks",size:"small",label:"Risks/Hazards",value:s.climate_risks,onChange:de,fullWidth:!0,sx:{marginBottom:1}})]}),(0,r.jsxs)(T.Z,{variant:"text",color:"primary",size:"small","aria-label":"outlined button controls group",children:[(0,r.jsx)(x.Z,{variant:"outlined",color:"error",onClick:fe,children:"Reset"}),(0,r.jsx)(K.Z,{isOpen:G,openButtonText:"CREATE",isDisabled:!ve||ce,loading:ce,maxWidth:"sm",title:"Create AMIA Village",confirmBtnText:"Submit",modalConfirmHandlerCB:function(){U(!1),me(s,m)},children:(0,r.jsx)(B.ZP,{container:!0,gap:2,sx:{paddingBottom:2},children:(0,r.jsx)(v.Z,{variant:"body1",color:"initial",children:"Do you want to submit this village?"})})})]}),J&&(0,r.jsx)(u.Z,{openSnackbar:!0,message:ae.message,severity:ae.severity,closeHandler:function(){Q(!1)}})]}),(0,r.jsx)(X,{extAddress:{province:s.province,municipality:s.municipality,barangay:s.barangay},coordinates:[s.lat,s.lon],open:W,onClose:function(){return H(!1)},onConfirm:function(e){try{var n,t,r;F((null===(n=o.find((function(n){return n.label===e.province})))||void 0===n?void 0:n.municipalities)||[]),D((null===(r=null===(t=o.find((function(n){return n.label===e.province})))||void 0===t?void 0:t.municipalities.find((function(n){return n.label===e.municipality})))||void 0===r?void 0:r.barangays)||[]),setTimeout((function(){c((function(n){return re({},n,{lat:e.lat.toString(),lon:e.lon.toString(),barangay:e.barangay||"",municipality:e.municipality||"",province:e.province||""})}))}),1e3)}catch(i){}H(!1)}})]})};function oe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function le(e,n,t,r,i,a,o){try{var l=e[a](o),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function se(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){le(a,r,i,o,l,"next",e)}function l(e){le(a,r,i,o,l,"throw",e)}o(void 0)}))}}function ce(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ue(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ce(e,n,t[n])}))}return e}function de(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return oe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oe(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var pe={association:"",barangay:"",municipality:"",province:"",lat:"",lon:"",phase:"",commodities:[],total_land_area:0,total_members:0,climate_risks:""};var fe=function(e){var n=e.villageData,t=e.onClose,a=e.onSuccess,o=e.crops,l=(0,i.useState)(pe),s=l[0],c=l[1],d=(0,i.useState)(null),m=d[0],h=d[1],g=(0,i.useState)(!1),b=g[0],y=g[1],M=(0,i.useState)(0),N=M[0],F=M[1],z=(0,i.useState)([]),D=z[0],R=z[1],W=(0,i.useState)([]),H=W[0],V=W[1],G=(0,i.useState)([]),U=G[0],$=G[1],J=(0,i.useState)(!1),Q=J[0],ee=J[1],ne=(0,i.useState)(!1),te=ne[0],re=ne[1],ie=(0,i.useState)(!1),ae=ie[0],oe=ie[1],le=(0,i.useState)({message:"",severity:""}),fe=le[0],me=le[1],ve=(0,i.useState)(!0),he=ve[0],ge=ve[1],be=(0,i.useRef)(!0),ye=["High Value Crops","Vegetables","Low-land Vegetables","Swine","Cattle","Goat","Poultry","Fish"];(0,i.useEffect)((function(){return function(){be.current=!1}}),[]);var xe=function(e,n){c((function(t){var r=t.commodities||[];return ue({},t,{commodities:n?de(r).concat([e]):r.filter((function(n){return n!==e}))})}))},je=function(e){var n,t=e.target,r=t.id,i=t.value,a=t.name;if(c((function(e){return ue({},e,ce({},r,i))})),"province"===a)V([]),$([]),c((function(e){return ue({},e,{province:i,municipality:"",barangay:""})})),V((null===(n=D.find((function(e){return e.label===i})))||void 0===n?void 0:n.municipalities)||[]);else if("municipality"===a){var o;$([]),c((function(e){return ue({},e,{municipality:i,barangay:""})})),$((null===(o=H.find((function(e){return e.label===i})))||void 0===o?void 0:o.barangays)||[])}else"barangay"===a?c((function(e){return ue({},e,{barangay:i})})):"phase"===a&&c((function(e){return ue({},e,{phase:i})}))},Ze=function(){var e=se(p().mark((function e(){var t,r,i,o,l,c,u,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===n||void 0===n?void 0:n.id){e.next=2;break}return e.abrupt("return");case 2:return ge(!0),e.prev=3,(t=new FormData).append("docId",n.id),t.append("association",s.association),t.append("lat",s.lat),t.append("lon",s.lon),t.append("province",s.province),t.append("municipality",s.municipality),t.append("barangay",s.barangay),t.append("phase",s.phase||""),t.append("commodities",JSON.stringify(s.commodities||[])),t.append("total_land_area",s.total_land_area||""),t.append("total_members",String(null!==(r=s.total_members)&&void 0!==r?r:"")),t.append("climate_risks",s.climate_risks||""),b?t.append("removeImage","true"):m&&(i=(new Date).toISOString().slice(0,10),o=m.name.split(".").pop()||"jpg",l=s.association.replace(/ /g,"_"),c="".concat(l,"_").concat(i,".").concat(o),t.append("image",m,c)),e.next=21,(0,Y.Qh)(t);case 21:u=e.sent,be.current&&(me({message:u.message||"Successfully updated village.",severity:"success"}),oe(!0),setTimeout((function(){be.current&&(oe(!1),ge(!1),a())}),2e3)),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(3),be.current&&(ge(!1),me({message:(null===e.t0||void 0===e.t0||null===(d=e.t0.response)||void 0===d?void 0:d.data)||"Failed to update village.",severity:"error"}),oe(!0),setTimeout((function(){be.current&&oe(!1)}),2e3));case 28:case"end":return e.stop()}}),e,null,[[3,25]])})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){var e,n=function(){var n=se(p().mark((function n(){var t,r,i,a,o,l,s,c,u,d,f,m,v,h,g,b;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,"https://firebasestorage.googleapis.com/v0/b/region1-dev.appspot.com/o/geojson%2Fbarangays-2025.geojson?alt=media&token=d7db3a0b-c000-40a1-8937-589e71327bc5",n.next=4,fetch("https://firebasestorage.googleapis.com/v0/b/region1-dev.appspot.com/o/geojson%2Fbarangays-2025.geojson?alt=media&token=d7db3a0b-c000-40a1-8937-589e71327bc5");case 4:return t=n.sent,n.next=7,t.json();case 7:for(r=n.sent,i=Array.isArray(null===r||void 0===r?void 0:r.features)?r.features:[],a=new Map,o=!0,l=!1,s=void 0,n.prev=11,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0)d=u.value,f=d.properties&&d.properties.NAME_1?d.properties.NAME_1:"",m=d.properties&&d.properties.NAME_2?d.properties.NAME_2:"",v=d.properties&&d.properties.NAME_3?d.properties.NAME_3:"",a.has(f)||a.set(f,{label:f,municipalities:new Map}),(h=a.get(f)).municipalities.has(m)||h.municipalities.set(m,{label:m,barangays:new Set}),g=h.municipalities.get(m),v&&g.barangays.add(v);n.next=19;break;case 15:n.prev=15,n.t0=n.catch(11),l=!0,s=n.t0;case 19:n.prev=19,n.prev=20,o||null==c.return||c.return();case 22:if(n.prev=22,!l){n.next=25;break}throw s;case 25:return n.finish(22);case 26:return n.finish(19);case 27:b=Array.from(a.values()).map((function(e){var n=Array.from(e.municipalities.values()).map((function(e){return{label:e.label,barangays:Array.from(e.barangays).sort((function(e,n){return e.localeCompare(n)})).map((function(e){return{label:e}}))}})).sort((function(e,n){return e.label.localeCompare(n.label)}));return{label:e.label,municipalities:n}})).sort((function(e,n){return e.label.localeCompare(n.label)})),be.current&&R(b),e=setTimeout((function(){be.current&&ge(!1)}),500),n.next=35;break;case 32:n.prev=32,n.t1=n.catch(0),be.current&&(me({message:(null===n.t1||void 0===n.t1?void 0:n.t1.message)||"Failed to fetch provinces.",severity:"error"}),oe(!0));case 35:case"end":return n.stop()}}),n,null,[[0,32],[11,15,19,27],[20,,22,26]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){e&&clearTimeout(e)}}),[]),(0,i.useEffect)((function(){if(n){var e,t,r;if(be.current)c({association:n.association||"",barangay:"-"===n.barangay?"":n.barangay||"",municipality:"-"===n.municipality?"":n.municipality||"",province:"-"===n.province?"":n.province||"",lat:"-"===n.lat?"":String(null!==(e=n.lat)&&void 0!==e?e:""),lon:"-"===n.lon?"":String(null!==(t=n.lon)&&void 0!==t?t:""),phase:"-"===n.phase?"":n.phase||"",commodities:n.commodities||[],total_land_area:"-"===n.total_land_area?"":n.total_land_area||"",total_members:"-"===n.total_members?0:null!==(r=n.total_members)&&void 0!==r?r:0,climate_risks:"-"===n.climate_risks?"":n.climate_risks||""}),h(null),y(!1);if(D.length>0&&n.province&&"-"!==n.province){var i=D.find((function(e){return e.label===n.province}));if(i&&(be.current&&V(i.municipalities||[]),n.municipality&&"-"!==n.municipality)){var a=i.municipalities.find((function(e){return e.label===n.municipality}));a&&be.current&&$(a.barangays||[])}}}}),[null===n||void 0===n?void 0:n.id,D,n]),(0,i.useEffect)((function(){if(0!==D.length&&(null===n||void 0===n?void 0:n.province)&&"-"!==n.province){var e=D.find((function(e){return e.label===n.province}));if(e&&(be.current&&V(e.municipalities||[]),n.municipality&&"-"!==n.municipality)){var t=e.municipalities.find((function(e){return e.label===n.municipality}));t&&be.current&&$(t.barangays||[])}}}),[D,null===n||void 0===n?void 0:n.province,null===n||void 0===n?void 0:n.municipality]);var _e=s.association&&s.lat&&s.lon&&s.province&&s.municipality&&s.barangay;return n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(j.Z,{open:!0,sx:{borderRadius:3},onClose:t,children:[(0,r.jsx)(Z.Z,{children:(0,r.jsx)(f.Z,{children:(0,r.jsx)(v.Z,{variant:"h5",children:"Edit AMIA Village"})})}),(0,r.jsx)(_.Z,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:8,top:8},children:(0,r.jsx)(I.Z,{})}),(0,r.jsx)(w.Z,{divider:!0,sx:{minWidth:"64vh",minHeight:"60vh"},children:he?(0,r.jsx)(f.Z,{children:(0,r.jsx)(L.Z,{})}):(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(q,{onFileSelect:h,resetTrigger:N,initialPreviewUrl:n.image_url||null,onRemove:function(){return y(!0)}}),(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Basic Information"})}),(0,r.jsx)(S.Z,{id:"association",name:"association",size:"small",label:"Association",value:s.association,onChange:je,fullWidth:!0,sx:{marginBottom:1}}),(0,r.jsxs)(f.Z,{sx:{display:"flex",gap:1},children:[(0,r.jsx)(S.Z,{id:"total_members",name:"total_members",size:"small",type:"number",label:"Total Members",value:s.total_members,onChange:je,fullWidth:!0,sx:{marginBottom:1}}),(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Phase"}),(0,r.jsxs)(P.Z,{name:"phase",value:s.phase,label:"phase",onChange:je,children:[(0,r.jsx)(A.Z,{value:"Phase I",children:"Phase I"}),(0,r.jsx)(A.Z,{value:"Phase II",children:"Phase II"}),(0,r.jsx)(A.Z,{value:"Phase III",children:"Phase III"}),(0,r.jsx)(A.Z,{value:"Phase IV",children:"Phase IV"})]})]})]}),(0,r.jsxs)(f.Z,{sx:{width:"100%",borderTop:"1px dashed grey"},children:[(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Commodities"})}),(0,r.jsxs)(f.Z,{children:[null===o||void 0===o?void 0:o.map((function(e){return(0,r.jsx)(O.Z,{control:(0,r.jsx)(E.Z,{checked:s.commodities.includes(e),onChange:function(n){return xe(e,n.target.checked)}}),label:e},e)})),null===ye||void 0===ye?void 0:ye.map((function(e){return(0,r.jsx)(O.Z,{control:(0,r.jsx)(E.Z,{checked:s.commodities.includes(e),onChange:function(n){return xe(e,n.target.checked)}}),label:e},e)}))]})]}),(0,r.jsxs)(f.Z,{sx:{paddingBlock:1,width:"100%",borderBlock:"1px dashed grey"},children:[(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Location"})}),(0,r.jsx)(B.ZP,{container:!0,gap:2,sx:{paddingBottom:2,alignItems:"center"},children:(0,r.jsx)(B.ZP,{size:2,children:(0,r.jsx)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:(0,r.jsxs)(B.ZP,{container:!0,gap:1,children:[(0,r.jsx)(B.ZP,{item:!0,md:4,xs:12,children:(0,r.jsx)(S.Z,{id:"lat",size:"small",label:"Latitude",value:s.lat,onChange:je,fullWidth:!0})}),(0,r.jsx)(B.ZP,{item:!0,md:4,xs:12,children:(0,r.jsx)(S.Z,{id:"lon",size:"small",label:"Longitude",value:s.lon,onChange:je,fullWidth:!0})}),(0,r.jsx)(B.ZP,{item:!0,md:3,xs:12,children:(0,r.jsx)(x.Z,{variant:"contained",color:"primary",onClick:function(){return ee(!0)},children:"Open Map"})})]})})})}),(0,r.jsxs)(B.ZP,{container:!0,gap:2,children:[(0,r.jsx)(B.ZP,{item:!0,md:3,xs:12,children:(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Province"}),(0,r.jsx)(P.Z,{name:"province",value:s.province,label:"province",onChange:je,children:D.map((function(e){return(0,r.jsx)(A.Z,{value:e.label,children:e.label},e.label)}))})]})}),(0,r.jsx)(B.ZP,{item:!0,md:4,xs:12,children:(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Municipality"}),(0,r.jsx)(P.Z,{name:"municipality",value:s.municipality,label:"municipality",onChange:je,children:H.map((function(e){return(0,r.jsx)(A.Z,{value:e.label,children:e.label},e.label)}))})]})}),(0,r.jsx)(B.ZP,{item:!0,md:3,xs:12,children:(0,r.jsxs)(C.Z,{size:"small",fullWidth:!0,sx:{marginBottom:1},children:[(0,r.jsx)(k.Z,{children:"Barangay"}),(0,r.jsx)(P.Z,{name:"barangay",value:s.barangay,label:"barangay",onChange:je,children:U.map((function(e){return(0,r.jsx)(A.Z,{value:e.label,children:e.label},e.label)}))})]})})]}),(0,r.jsx)(S.Z,{id:"total_land_area",name:"total_land_area",type:"number",size:"small",label:"Total Land Area (ha)",value:s.total_land_area,onChange:je,fullWidth:!0,sx:{marginBottom:1}})]}),(0,r.jsx)(v.Z,{variant:"body1",color:"primary",children:(0,r.jsx)("strong",{children:"Climate-Related Risks/Hazards"})}),(0,r.jsx)(S.Z,{id:"climate_risks",name:"climate_risks",size:"small",label:"Risks/Hazards",value:s.climate_risks,onChange:je,fullWidth:!0,sx:{marginBottom:1}})]})}),(0,r.jsxs)(T.Z,{variant:"text",color:"primary",size:"small",children:[(0,r.jsx)(x.Z,{variant:"outlined",color:"error",onClick:function(){var e,t,r;n&&(c({association:n.association||"",barangay:"-"===n.barangay?"":n.barangay||"",municipality:"-"===n.municipality?"":n.municipality||"",province:"-"===n.province?"":n.province||"",lat:"-"===n.lat?"":String(null!==(e=n.lat)&&void 0!==e?e:""),lon:"-"===n.lon?"":String(null!==(t=n.lon)&&void 0!==t?t:""),phase:"-"===n.phase?"":n.phase||"",commodities:n.commodities||[],total_land_area:"-"===n.total_land_area?"":n.total_land_area||"",total_members:"-"===n.total_members?0:null!==(r=n.total_members)&&void 0!==r?r:0,climate_risks:"-"===n.climate_risks?"":n.climate_risks||""}),h(null),y(!1),F((function(e){return e+1})))},children:"Reset"}),(0,r.jsx)(K.Z,{isOpen:te,openButtonText:"UPDATE",isDisabled:!_e||he,loading:he,maxWidth:"sm",title:"Update AMIA Village",confirmBtnText:"Submit",modalConfirmHandlerCB:function(){re(!1),Ze()},children:(0,r.jsx)(B.ZP,{container:!0,gap:2,sx:{paddingBottom:2},children:(0,r.jsx)(v.Z,{variant:"body1",color:"initial",children:"Do you want to save changes to this village?"})})})]}),ae&&(0,r.jsx)(u.Z,{openSnackbar:!0,message:fe.message,severity:fe.severity,closeHandler:function(){return oe(!1)}})]}),(0,r.jsx)(X,{extAddress:{province:s.province,municipality:s.municipality,barangay:s.barangay},coordinates:[s.lat,s.lon],open:Q,onClose:function(){return ee(!1)},onConfirm:function(e){try{var n,t,r,i;V((null===(n=D.find((function(n){return n.label===e.province})))||void 0===n?void 0:n.municipalities)||[]),$((null===(i=null===(t=D.find((function(n){return n.label===e.province})))||void 0===t||null===(r=t.municipalities)||void 0===r?void 0:r.find((function(n){return n.label===e.municipality})))||void 0===i?void 0:i.barangays)||[]),setTimeout((function(){be.current&&c((function(n){return ue({},n,{lat:e.lat.toString(),lon:e.lon.toString(),barangay:e.barangay||"",municipality:e.municipality||"",province:e.province||""})}))}),1e3)}catch(a){}ee(!1)}})]}):null},me=t(38885);function ve(e,n,t,r,i,a,o){try{var l=e[a](o),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function he(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ge(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){he(e,n,t[n])}))}return e}function be(e){return(0,r.jsx)(f.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,r.jsxs)(h.D,ge({},e,{children:[(0,r.jsx)(g.S,{}),(0,r.jsx)(b.M,{})]}))})}var ye=function(e){var n=e.rows,t=e.columns,o=e.message,l=e.resetMessage,s=e.onRefresh,d=(0,a.v9)((function(e){return e.villages.status})),h=(0,i.useState)(null),g=h[0],b=h[1],j=(0,i.useState)([]),Z=j[0],_=j[1],w=(0,i.useState)(""),S=w[0],C=w[1],k=(0,i.useRef)(!0),P=(0,me.Z)(!1).cropList;(0,i.useEffect)((function(){return function(){k.current=!1}}),[]);var A=function(){C(""),s()};return(0,i.useEffect)((function(){var e=function(){var e,n=(e=p().mark((function e(){var n,t,r,i,a,o,l,s,c,u,d,f,m,v,h,g;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,fetch("https://firebasestorage.googleapis.com/v0/b/region1-dev.appspot.com/o/geojson%2Fbarangays-2025.geojson?alt=media&token=d7db3a0b-c000-40a1-8937-589e71327bc5");case 4:return n=e.sent,e.next=7,n.json();case 7:for(t=e.sent,r=Array.isArray(t.features)?t.features:[],i=new Map,a=!0,o=!1,l=void 0,e.prev=11,s=r[Symbol.iterator]();!(a=(c=s.next()).done);a=!0)u=c.value,d=u.properties&&u.properties.NAME_1?u.properties.NAME_1:"",f=u.properties&&u.properties.NAME_2?u.properties.NAME_2:"",m=u.properties&&u.properties.NAME_3?u.properties.NAME_3:"",i.has(d)||i.set(d,{label:d,municipalities:new Map}),(v=i.get(d)).municipalities.has(f)||v.municipalities.set(f,{label:f,barangays:new Set}),h=v.municipalities.get(f),m&&h.barangays.add(m);e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),o=!0,l=e.t0;case 19:e.prev=19,e.prev=20,a||null==s.return||s.return();case 22:if(e.prev=22,!o){e.next=25;break}throw l;case 25:return e.finish(22);case 26:return e.finish(19);case 27:g=Array.from(i.values()).map((function(e){var n=Array.from(e.municipalities.values()).map((function(e){return{label:e.label,barangays:Array.from(e.barangays).sort((function(e,n){return e.localeCompare(n)})).map((function(e){return{label:e}}))}})).sort((function(e,n){return e.label.localeCompare(n.label)}));return{label:e.label,municipalities:n}})).sort((function(e,n){return e.label.localeCompare(n.label)})),k.current&&_(g),e.next=34;break;case 31:e.prev=31,e.t1=e.catch(0),k.current&&_([]);case 34:case"end":return e.stop()}}),e,null,[[0,31],[11,15,19,27],[20,,22,26]])})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){ve(a,r,i,o,l,"next",e)}function l(e){ve(a,r,i,o,l,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();e()}),[]),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.Z,{openSnackbar:""!==o,message:o,severity:"info",closeHandlerCB:l}),(0,r.jsx)(v.Z,{variant:"h5",children:"Villages List"}),(0,r.jsxs)("p",{children:["Manage ",(0,r.jsx)("strong",{children:"AMIA Villages"}),"."]}),(0,r.jsx)(m.Z,{sx:{display:"flex",flexDirection:{sm:"column",md:"row"},justifyContent:"space-between",alignItems:"center",padding:"8px 16px 8px 24px"},children:(0,r.jsx)(x.Z,{variant:"contained",color:"primary",onClick:function(){return C("create")},children:"New Village"})}),(0,r.jsx)(f.Z,{style:{height:678,width:"100%",textAlign:"left"},children:(0,r.jsx)(m.Z,{sx:{height:"inherit",marginTop:"16px"},children:(0,r.jsx)(y._,{rows:n.length>0?n:[],columns:t,disableDensitySelector:!0,pageSize:10,rowsPerPageOptions:[10],components:{Toolbar:be},loading:d===c.G.PENDING,rowHeight:48,onRowClick:function(e){return function(e){if(e.id){var t=e.id,r=n.find((function(e){return e.id===t}));b(r),C("update")}else b(null),C("")}(e)},initialState:{columns:{columnVisibilityModel:{rowId:!1}}}})})}),"update"===S&&(0,r.jsx)(fe,{villageData:g,crops:P,provinces:Z,onClose:function(){return C("")},onSuccess:A}),"create"===S&&(0,r.jsx)(ae,{villages:n,crops:P,provinces:Z,onClose:function(){return C("")},onSuccess:A})]})},xe=t(52749);var je=(0,o.Z)((function(e){var n=(0,i.useState)([]),t=n[0],o=n[1],d=(0,i.useState)([]),p=d[0],f=d[1],m=(0,i.useState)(""),v=m[0],h=m[1],g=(0,i.useRef)(!1),b=(0,a.I0)(),y=(0,i.useState)(!1),x=y[0],j=y[1],Z=(0,i.useState)({}),_=Z[0],w=Z[1],S=(0,i.useState)(!1),C=S[0],k=S[1],P=(0,a.v9)((function(e){return e.villages})),A=P.ids,O=P.entities,E=P.status;return(0,i.useEffect)((function(){return g.current=!0,function(){g.current=!1}}),[]),(0,i.useEffect)((function(){if([c.G.FULLFILLED,c.G.IDLE].includes(E)&&A.length>0){var e={association:"Association",barangay:"Barangay",municipality:"Municipality",province:"Province",lat:"Latitude",lon:"Longitude",phase:"Phase",updated_by:"Updated by",updated_on:"Updated on"},n={association:400,barangay:100,municipality:160,province:50,lat:20,lon:20,phase:50,updated_by:150,updated_on:100},t=[];["association","barangay","municipality","province","lat","lon","phase","updated_by","updated_on"].forEach((function(r){t.push({field:r,headerName:e[r],minWidth:n[r],flex:void 0===n[r]?1:0,editable:!1,sortable:!1,disableColumnMenu:!0})}));var r=A.map((function(e){var n;return{id:O[e].id,association:O[e].association,total_members:O[e].total_members||0,total_land_area:O[e].total_land_area||0,commodities:O[e].commodities||[],barangay:O[e].barangay||"-",municipality:O[e].municipality||"-",province:O[e].province||"-",lat:O[e].lat||"-",lon:O[e].lon||"-",phase:O[e].phase||"-",climate_risks:null===(n=O[e])||void 0===n?void 0:n.climate_risks,image_url:O[e].image_url||null,image_filename:O[e].image_filename||null,updated_by:O[e].updated_by||"N/A",updated_at:O[e].updated_at||"N/A"}}));g.current&&(o(r),f(t))}}),[E,A,O]),(0,i.useEffect)((function(){b((0,xe.vY)()).unwrap().then((function(e){!function(e){e.length>0?w({message:"Successfully fetched ".concat(e.length," villages."),severity:"info"}):w({message:"No villages available.",severity:"info"})}(e)})).catch((function(e){console.error("Error fetching villages:",e),h("Failed to fetch villages.")}))}),[C,b]),(0,r.jsxs)(l.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:s.DW.ADMIN,children:[(0,r.jsx)(ye,{rows:t,columns:p,loadingCrops:E===c.G.PENDING,message:v,resetMessage:function(){return h("")},onRefresh:function(){k((function(e){return!e})),b((0,xe.vY)())}}),!E&&x&&(0,r.jsx)(u.Z,{openSnackbar:!0,message:_.message,severity:_.severity,closeHandler:function(){j(!1)}})]})}))},38885:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(34051),i=t.n(r),a=t(67294),o=t(32848);function l(e,n,t,r,i,a,o){try{var l=e[a](o),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function s(e){var n=(0,a.useState)([]),t=n[0],r=n[1],s=(0,a.useState)(!1),c=s[0],u=s[1],d=(0,a.useState)(""),p=d[0],f=d[1];return(0,a.useEffect)((function(){var n=function(){var n,t=(n=i().mark((function n(){var t,a,l,s,c;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,u(!0),t=[],n.next=5,(0,o.TQ)();case 5:a=n.sent,e?a.map((function(n){e&&!n.data.hasCalendar||t.push(n.data.name)})):a.map((function(e){return t.push(e.data.name)})),r(null!==t&&void 0!==t?t:[]),u(!1),f(""),n.next=20;break;case 12:n.prev=12,n.t0=n.catch(0),c=null!==(s=null===n.t0||void 0===n.t0||null===(l=n.t0.response)||void 0===l?void 0:l.data)&&void 0!==s?s:n.t0.message,f(c),u(!1),r([]);case 20:case"end":return n.stop()}}),n,null,[[0,12]])})),function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){l(a,r,i,o,s,"next",e)}function s(e){l(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();n()}),[]),{cropList:t,loading:c,error:p}}}},function(e){e.O(0,[5778,2702,8858,8333,6223,6279,4597,7944,7067,1433,4343,1050,9774,2888,179],(function(){return n=41397,e(e.s=n);var n}));var n=e.O();_N_E=n}]);